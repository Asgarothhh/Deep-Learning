# Chest X-Ray Pneumonia Detection

–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏ –æ–±—É—á–µ–Ω–∏–µ —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (CNN) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø–Ω–µ–≤–º–æ–Ω–∏–∏ –ø–æ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏–º —Å–Ω–∏–º–∫–∞–º –≥—Ä—É–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

–î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ —Ç—Ä–∏ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞:
- **Train** ‚Äî 6000 —Å–Ω–∏–º–∫–æ–≤ –±–µ–∑ –ø–Ω–µ–≤–º–æ–Ω–∏–∏ –∏ 800 —Å–Ω–∏–º–∫–æ–≤ —Å –ø–Ω–µ–≤–º–æ–Ω–∏–µ–π
- **Validation** ‚Äî 2000 —Å–Ω–∏–º–∫–æ–≤ –±–µ–∑ –ø–Ω–µ–≤–º–æ–Ω–∏–∏ –∏ 200 —Å –ø–Ω–µ–≤–º–æ–Ω–∏–µ–π
- **Test** ‚Äî 2192 —Å–Ω–∏–º–∫–∞ –±–µ–∑ –ø–Ω–µ–≤–º–æ–Ω–∏–∏ –∏ 345 —Å –ø–Ω–µ–≤–º–æ–Ω–∏–µ–π

–§–∞–π–ª—ã —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–ª–∏—Å—å –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º.

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏

–ú–æ–¥–µ–ª—å —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (CNN) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Keras –∏ –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

- `Conv2D` (32 —Ñ–∏–ª—å—Ç—Ä–∞, —Ä–∞–∑–º–µ—Ä —è–¥—Ä–∞ 3x3, ReLU, L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è)
- `MaxPooling2D` (2x2)
- `Conv2D` (64 —Ñ–∏–ª—å—Ç—Ä–∞, ReLU, L2)
- `MaxPooling2D`
- `Conv2D` (64 —Ñ–∏–ª—å—Ç—Ä–∞, ReLU, L2=0.01)
- `MaxPooling2D`
- `Conv2D` (128 —Ñ–∏–ª—å—Ç—Ä–æ–≤, ReLU, L2=0.01)
- `MaxPooling2D`
- `Conv2D` (128 —Ñ–∏–ª—å—Ç—Ä–æ–≤, ReLU, L2=0.001)
- `MaxPooling2D`
- `Dropout` (0.5)
- `Flatten`
- `Dense` (512 –Ω–µ–π—Ä–æ–Ω–æ–≤, ReLU)
- `Dense` (1 –Ω–µ–π—Ä–æ–Ω, —Å–∏–≥–º–æ–∏–¥–∞ ‚Äî –±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)

–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: `binary_crossentropy`  
–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: `Adam`  
–ú–µ—Ç—Ä–∏–∫–∞: `accuracy`

## ‚öôÔ∏è –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è:
- –í—Ä–∞—â–µ–Ω–∏–µ, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–¥–≤–∏–≥–∏, –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ
- –Ø—Ä–∫–æ—Å—Ç—å, —Å–¥–≤–∏–≥ –∫–∞–Ω–∞–ª–æ–≤
- `fill_mode='reflect'`

## üîÅ –û–±—É—á–µ–Ω–∏–µ

–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:

1. **–ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ**
   ```python
   model.fit(
       train_generator,
       steps_per_epoch=340,
       epochs=50,
       validation_data=validation_generator,
       validation_steps=110
   )
2. **–§–∏–Ω–∞–ª—å–Ω–æ–µ –¥–æ–æ–±—É—á–µ–Ω–∏–µ —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –∏ callbacks**
    ```python
    callbacks_final = [
    EarlyStopping(
        monitor='loss',
        patience=5,
        restore_best_weights=True
    ),
    ReduceLROnPlateau(
        monitor='loss',
        factor=0.5,
        patience=2,
        min_lr=1e-6
    )
    ]

    merged_gen = combined_generator(train_generator, validation_generator)

    total_steps = train_generator.samples // train_generator.batch_size \
            + validation_generator.samples // validation_generator.batch_size

    history = model.fit(
        merged_gen,
        steps_per_epoch=total_steps,
        epochs=30,
        callbacks=callbacks_final
    )

## üß™ –û—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å –æ—Ç–∫–ª—é—á—ë–Ω–Ω—ã–º –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ–º:

    results = model.evaluate(test_generator, 
                         steps=test_generator.samples//test_generator.batch_size,
                         verbose = 1)
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–≤–æ–¥—è—Ç—Å—è –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º:
- loss: —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å
- acc: —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ

## üìå –ó–∞–º–µ—Ç–∫–∏

- –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ —Ñ–æ—Ä–º–∞—Ç—É grayscale –∏ —Ä–∞–∑–º–µ—Ä—É 224x224.
- –ü–ª–æ—Ö–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ PIL.
- –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –∏ Dropout.
